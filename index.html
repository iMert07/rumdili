<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yapay Dil Sözlüğü</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Yapay Dil Sözlüğü</h1>
        <input type="text" id="searchInput" placeholder="Kelime ara...">
        <div id="suggestions"></div> <!-- Öneri Listesi -->
        <div id="result"></div> <!-- Sonuç Ekranı -->
    </div>

    <script>
      async function fetchWords() {
        const sheetId = '1R01aIajx6dzHlO-KBiUXUmld2AEvxjCQkUTFGYB3EDM';
        const sheetName = 'Sayfa1';
        const url = `https://opensheet.elk.sh/${sheetId}/${sheetName}`;

        try {
          const response = await fetch(url);
          const data = await response.json();

          const searchInput = document.getElementById('searchInput');
          const resultDiv = document.getElementById('result');
          const suggestionsDiv = document.getElementById('suggestions'); // Öneri alanı

          let selectedWord = null; // Seçilen kelimeyi tutacak

          // Her harf girişiyle anında arama
          searchInput.addEventListener('input', () => {
            const query = searchInput.value.trim().toLowerCase();
            if (!query) {
              // Eğer arama kutusu boşsa, önerileri temizle fakat sonuçları bırak
              suggestionsDiv.innerHTML = '';
              return;
            }

            // Kısmi eşleşme yapan kelimeleri buluyoruz
            const matches = data.filter(row => {
              const wordMatch = row.Sözcük?.toLowerCase().includes(query); // Sözcükte kısmi eşleşme
              const synonymsMatch = row['Eş Anlamlılar']?.toLowerCase().split(',').map(x => x.trim()).some(syn => syn.includes(query)); // Eş anlamlılarda kısmi eşleşme
              return wordMatch || synonymsMatch;
            });

            // Öneri listesini oluşturuyoruz
            suggestionsDiv.innerHTML = '';

            // En hızlı eşleşen kelimeleri önce göster
            const sortedMatches = matches
              .sort((a, b) => {
                // Kısa kelimeler önce sıralansın
                const lengthDifference = a.Sözcük.length - b.Sözcük.length;
                if (lengthDifference !== 0) return lengthDifference;

                // Uzun kelimeler eşit uzunluktaysa, alfabetik sıralama yapılır
                return a.Sözcük.localeCompare(b.Sözcük);
              });

            // Sadece 6 öneri gösterecek
            const topMatches = sortedMatches.slice(0, 6);

            topMatches.forEach(match => {
              const suggestion = document.createElement('div');
              suggestion.textContent = match.Sözcük;
              suggestion.classList.add('suggestion');
              suggestion.addEventListener('click', () => {
                selectedWord = match; // Seçilen kelimeyi kaydet
                showResult(match); // Sonucu güncelle
              });
              suggestionsDiv.appendChild(suggestion);
            });

            // Eğer kelime seçilmediyse, sadece önerileri göster
            if (!selectedWord && topMatches.length > 0) {
              showResult(topMatches[0]); // İlk öneriyi göster
            }
          });

          // Sonuçları göster
          function showResult(word) {
            resultDiv.innerHTML = `
              <div>
                <strong>${word.Sözcük}</strong><br>
                <span style="color: gray;">(${word['Eş Anlamlılar']})</span><br>
                <p>${word.Açıklama || ''}</p>
              </div>
            `;
          }
        } catch (error) {
          console.error('Veri çekme hatası:', error);
        }
      }

      window.onload = fetchWords;
    </script>

    <style>
      .suggestion {
        padding: 8px;
        background-color: #f0f0f0;
        margin: 4px 0;
        cursor: pointer;
      }
      .suggestion:hover {
        background-color: #e0e0e0;
      }

      /* Öneri kısmının boyutunu sabitle */
      #suggestions {
        max-height: 200px; /* Sabit yükseklik */
        overflow-y: auto; /* Kaydırma çubuğu ekle */
        margin-top: 10px;
      }
    </style>
</body>
</html>
