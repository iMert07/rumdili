<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RUM TILI</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>RUM TILI</h1>
        <input type="text" id="searchInput" placeholder="SÖZCÜK ARA...">
        <div id="suggestions"></div> <!-- Öneri Listesi -->
        <div id="result"></div> <!-- Sonuç Ekranı -->
    </div>

    <script>
      async function fetchWords() {
        const sheetId = '1R01aIajx6dzHlO-KBiUXUmld2AEvxjCQkUTFGYB3EDM';
        const sheetName = 'Sayfa1';
        const url = `https://opensheet.elk.sh/${sheetId}/${sheetName}`;

        try {
          const response = await fetch(url);
          const data = await response.json();

          const searchInput = document.getElementById('searchInput');
          const resultDiv = document.getElementById('result');
          const suggestionsDiv = document.getElementById('suggestions'); // Öneri alanı

          let selectedWord = null; // Seçilen kelimeyi tutacak
          let lastSearchQuery = ''; // Son arama sorgusunu tutacak

          // Her harf girişiyle anında arama
          searchInput.addEventListener('input', () => {
            const query = searchInput.value.trim().toLowerCase();

            if (query === '') {
              // Eğer arama kutusu boşsa, sadece önerileri temizle
              suggestionsDiv.innerHTML = '';
              return;
            }

            if (query !== lastSearchQuery) {
              // Sadece yeni arama yapıldığında sonuçları güncelle
              lastSearchQuery = query;
            }

            // Kısmi eşleşme yapan kelimeleri buluyoruz
            const matches = data.filter(row => {
              const wordMatch = row.Sözcük?.toLowerCase().includes(query); // Sözcükte kısmi eşleşme
              const synonymsMatch = row['Eş Anlamlılar']?.toLowerCase().split(',').map(x => x.trim()).some(syn => syn.includes(query)); // Eş anlamlılarda kısmi eşleşme
              return wordMatch || synonymsMatch;
            });

            // Öneri listesini oluşturuyoruz
            suggestionsDiv.innerHTML = '';

            // Yalnızca alfabetik sıralama
            const sortedMatches = matches.sort((a, b) => a.Sözcük.localeCompare(b.Sözcük));

            // Sadece 6 öneri gösterecek
            const topMatches = sortedMatches.slice(0, 6);

            topMatches.forEach(match => {
              const suggestion = document.createElement('div');
              suggestion.textContent = match.Sözcük;
              suggestion.classList.add('suggestion');
              suggestion.addEventListener('click', () => {
                if (selectedWord === match) return; // Aynı kelime tekrar seçilmesin
                selectedWord = match; // Seçilen kelimeyi kaydet
                showResult(match); // Sonucu güncelle
                searchInput.value = match.Sözcük; // Arama kutusuna seçilen kelimeyi ekle
                suggestionsDiv.innerHTML = ''; // Önerileri temizle
              });
              suggestionsDiv.appendChild(suggestion);
            });
          });

          // Sonuçları göster
          function showResult(word) {
            if (word && selectedWord !== null) {
              resultDiv.innerHTML = `
                <div>
                  <strong>${word.Sözcük}</strong><br>
                  <span style="color: gray;">(${word['Eş Anlamlılar']})</span><br>
                  <p>${word.Açıklama || ''}</p>
                </div>
              `;
            } else {
              resultDiv.innerHTML = ''; // Başlangıçta boş olacak
            }
          }
        } catch (error) {
          console.error('Veri çekme hatası:', error);
        }
      }

      window.onload = fetchWords;
    </script>

    <style>
      .suggestion {
        padding: 8px;
        background-color: #f0f0f0;
        margin: 4px 0;
        cursor: pointer;
      }
      .suggestion:hover {
        background-color: #e0e0e0;
      }

      /* Öneri kısmının boyutunu sabitle */
      #suggestions {
        max-height: 200px; /* Sabit yükseklik */
        overflow-y: auto; /* Kaydırma çubuğu ekle */
        margin-top: 10px;
      }
    </style>
</body>
</html>
